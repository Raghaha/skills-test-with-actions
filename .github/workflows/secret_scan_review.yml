name: review secrets findings in ghas

on:
  workflow_dispatch:

permissions:
  security-events: read

jobs:
  job1:
    runs-on: ubuntu-latest
    outputs:
      output1: ${{ steps.read_secret_scan.outputs.SCANNED_SECRET }}
    steps: 
      - id: read_secret_scan
        run: |
          SCANNED_SECRET="$(curl -L -H "Accept: application/vnd.github+json" -H "Authorization: Bearer ${{ secrets.GHAS_PAT }}" -H "X-GitHub-Api-Version: 2022-11-28" https://api.github.com/repos/Raghaha/skills-test-with-actions/secret-scanning/alerts | jq -r '.[].secret')"  >> "$GITHUB_OUTPUT"
  job2:
    runs-on: ubuntu-latest
    needs: job1
    steps:
      - env:
          OUTPUT1: ${{needs.job1.outputs.SCANNED_SECRET}}
        run: echo "$OUTPUT1"
